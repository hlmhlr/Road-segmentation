# SegRExtNet: A Deep Learning-based road segmentation

This project implements a deep learning model for aerial image segmentation, particularly focusing on roads detection using CNN-based architectures.


---
## 📁 Project Structure
<pre lang="markdown"> 
├── checkpoints/ # Saved model weights (.pth) 
├── dataset/ # Dataset root │ 
    ├── train/ │ 
    │ ├── image/ # Training images │ 
    │ └── mask/ # Ground-truth masks │ 
    ├── val/ │ 
    │ ├── image/ # Validation images │ 
    │ └── mask/ # Validation masks │ 
    └── test/ 
    │ ├── image/ # Test images 
    │ └── mask/ # Test masks (optional) 
├── outputs/ # Predicted masks generated by test.py 
├── logs/ # TensorBoard & txt logs │ 
├── train.py # Train / fine-tune a model 
├── test.py # Evaluate a checkpoint or export predictions │ 
├── model.py # Vanilla UNet / CompNet definitions ├── model_mnetv3_2_ca_sa.py # MobileNetV3 backbone│ 
├── loss.py # BCE, Dice, Tversky, etc. 
├── Hybrid_Eloss.py # Experimental hybrid edge loss │ 
├── utils.py # Metric calculators, I/O helpers, seeds 
├── data.py # PyTorch Dataset & Dataloader wrappers │ 
├── requirements.txt # Exact package versions 
└── README.md # You’re here  </pre>

## ⚙️ Installation

1. **Clone the repository**

```bash
git clone https://github.com/hlmhlr/Road-segmentation.git
cd road_segmentation
pip install -r requirements.txt
```

2. **Install dependencies**

```bash
pip install -r requirements.txt
```
✅ Tip: Use a virtual environment:

```bash
conda create -n segrext python=3.8
conda activate segrext
```

## 🚀 Usage

▶️ Training the Model

```bash
python train.py \
    --path ./dataset \
    --checkpoint_path ./checkpoints/best_model.pth \
    --train_log_path ./logs/train_log.txt \
    --batch_size 1 \
    --num_epochs 50
```
Arguments:

--path: Root path to the dataset.

--checkpoint_path: Where to save the trained .pth model.

--train_log_path: File to log loss and metrics.

--batch_size: Batch size for training.

--num_epochs: Number of training epochs.



## 🧪 Testing / Inference
```bash
python test.py \
    --path ./dataset \
    --checkpoint_path ./checkpoints/best_model.pth \
    --results_path ./outputs
```
Arguments:

--path: Dataset path (should include test/image and test/mask).

--checkpoint_path: Path to the trained model file.

--results_path: Folder to save the predicted masks.


## 🧾 Dataset Format
The dataset must follow the structure as mentioned in the project structre above and all images are kept as .png files.

## 📈 Output & Metrics
At the end of testing, the following segmentation metrics are printed and saved:

Jaccard Index (IoU)

F1 Score

Recall

Precision

Accuracy

F2 Score

Inference FPS (Frames per Second)

Outputs:
Predicted masks are saved to the outputs/mask folder.

Evaluation results are stored in a .csv file inside the results directory.

## 📌 Notes
Images are resized to 256×256 before inference.

Predicted masks are binarized with a threshold of 0.5.

The model is evaluated on test.py using ground-truth masks.

The entire code supports CUDA if a GPU is available.


---
